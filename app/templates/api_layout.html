
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Transit API - Make Train Apps!</title>

    <!-- Bootstrap core CSS -->
    {% assets "api_css" %}
      <link href="{{ ASSET_URL }}" rel="stylesheet">
    {% endassets %}

    <style type="text/css">
      body {
        padding-top: 20px;
        padding-bottom: 20px;
      }

      .navbar {
        margin-bottom: 20px;
      }
			.footer{
						position: absolute;
				    bottom: 0;
				    width: 100%;
				    height: 50px;
						padding-top:10px;
				    background-color: #f5f5f5;
			}
			
    </style>
  </head>

  <body>

    <div class="container">
      <nav class="navbar navbar-light bg-faded">
        <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#navbar-header" aria-controls="navbar-header">
          &#9776;
        </button>
        <div class="collapse navbar-toggleable-xs" id="navbar-header">
          <a class="navbar-brand" href="#">Transit API</a>
          <ul class="nav navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="/api">Home <span class="sr-only">(current)</span></a>
            </li>
           
            <li class="nav-item">
              <a class="nav-link" href="/api/keys">API Key</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/api/docs">Documentation</a>
            </li>
            <!--li class="nav-item">
              <a class="nav-link" href="/api/status">Status</a>
            </li-->
          </ul>
          <!--form class="form-inline pull-xs-right">
            <input class="form-control" type="text" placeholder="Search">
            <button class="btn btn-success-outline" type="submit">Search</button>
          </form-->
        </div>
      </nav> <!-- /navbar -->

      <!-- Main component for a primary marketing message or call to action -->
    {% block body %}{% endblock %}
		
		
		
		
		
    </div> <!-- /container -->
		
		<footer class="footer" role="contentinfo">
		        <div class="container">
		            <p>
		                Made in Toronto by <a href="http://propellerhead.com" title="Propellerhead Labs">Propellerhead Labs</a>.  Inspired by Crunchy Roll.
		            </p>
		            
		        </div>
		    </footer>


        <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
    {% assets "common_js" %}
      <script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}

    <script>
      $(document).ready(function(){
        var depart_station, arrival_station, depart_time, travel_date;

        $('#prestocard_number').mask('0000 0000 0000 00000');

        var picker = new Pikaday({
          field: document.getElementById('datepicker'),
          minDate: moment().subtract(7, 'days').toDate(),
          maxDate: moment().toDate(),
          onSelect: function(){
            travel_date = moment(this.getDate()).day();
          }
        });

        picker.setDate(moment().toDate());

        $('form').on('change', '#depart_station',function(){
          $('#arrival_station, #depart_time').empty();
          var $this = $(this);
          if($(this).val() != ""){
            $.get('/api/go/stops/' + $(this).val(), function(r){
              $.each(r.routes, function(i, e){
                if(e.stop_id != $this.val()){
                  $('#arrival_station').append('<option value="' + e.stop_id + '">' + e.stop_name + '</option>');
                }
              });
            });

            depart_station = $this.val();
          }
        });

        $('form').on('change', '#arrival_station', function(){
          var $this = $(this);
          arrival_station = $this.val();
          $.get('/api/go/search/' + depart_station + '/' + arrival_station + '/' + travel_date, function(r){
            $('#depart_time').empty();
            $.each(r.trips, function(i, e){
              $('#depart_time').append('<option value="' + e.trip_id + '">' + e.departure_time + '</option>');
            });
          });
        });
      });
    </script>
  </body>
</html>
